README

=========================================================================================================
Instructions for using four-chamber mesh generation pipeline
=========================================================================================================

=========================================================================================================
Segmentation
=========================================================================================================
1) Make folder (e.g. henry) in /data/Dropbox then make folder “segmentations” inside
2) Copy “points.txt”, “labels.txt”, “origin_spacing.txt” and “origin_spacing_labels.txt” templates into folder (currently in “h_templates” folder)
3) Move segmented CT into folder.
4) Manually split and relabel pulmonary veins (Seg3D for now)
5) Export the segmentation as “seg_corrected.nrrd”

6) Run “find_origin_and_spacing.py [path2points]”
7) Copy origin and spacing into respective “.txt” files
8) Run “txt_2_json.py [points.txt] [labels.txt] [output.json]”
	a. Note: output.json = path + “origin_spacing.json”

9) Select 3 points for SVC and IVC and save in “points.txt”
10) Select 3 points for Ao_slicer and for PArt_slicer and save in “points.txt”
    a. Note: be careful not to crop the PArt too close to the RV_BP
11) Run “create_cylinders.py [path_to_points]”

12) Run “create_svc_ivc.py [path_to_points]”

13) Select seed points for SVC_tip and IVC_tip
    a. Note: tips are used for removing sections protruding from wrong side of RA
14) Select a seed point for the Ao_tip and PArt_tip
15) Select 3 points for SVC_slicer and IVC_slicer and save in “points.txt”
16) Run “crop_svc_ivc.py [path_to_points]”

17) Run “create_myo.py [path_to_points]”

18) Select a seed point for the Ao_wall_tip and PArt_wall_tip
19) Run “create_valve_planes.py [path_to_points]”

20) Run “clean_seg.py [path_to_points]”

21) Load .nrrd and manually clean valve ring
22) Export segmentation as “seg_final.nrrd”

23) Run “segSmoothing.sh”

24) Run “meshing.py [heart_folder]”

25) cd into the meshing folder (inside heart folder)
26) Run “bash generate_heart_mesh_Cesare.sh”

27) Run “bash mesh_post.sh [heart_folder]” ## watch out mesh tool path currently hard-coded ##

28) Run “bash surfaces_extraction_uvc.sh [heart_folder]”
	a. Note: the base number in “pick apex” refers to the LA in the segmentation (104) so watch out for this step if segmentation labels change

29) Run “extract_bivmesh_uvc.sh [heart_folder]” – watch out – scriptsPath hardcoded

30) Run “runUVC.sh [heart_folder]”

31) Run “surfaces_extraction_fibres_la.sh [heart_folder]”

32) Run “extract_la.sh [heart_folder]”

33) Use “la.vtk” to select points for the la apex and la septum
34) Run “runUVC_la.sh [heart_folder]”
 
35) Run “surfaces_extraction_fibres_ra.sh [heart_folder]”

36) Run “extract_ra.sh [heart_folder]”

37) Use “ra.vtk” to select points for the ra apex and ra septum 

38) Run “runUVC_ra.sh [heart_folder]”













